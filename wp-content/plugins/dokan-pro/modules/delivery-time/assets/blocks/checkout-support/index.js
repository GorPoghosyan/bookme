(()=>{"use strict";var e,t={64:(e,t,o)=>{const r=window.React,l=window.wp.i18n,n=({time:e=""})=>e?(0,r.createElement)("div",{className:"header"},(0,r.createElement)("h3",null,(0,l.__)("Delivery details","dokan")),(0,r.createElement)("div",{className:"delivery-timezone dokan-delivery-time-tooltip","data-tip":(0,l.__)("Date & time is based on current site time.","dokan")},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",height:"18",viewBox:"0 0 24 24",stroke:"#333333"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.85",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})),(0,r.createElement)("span",null,e))):"",a=({isLoading:e=!1})=>(0,r.createElement)("div",{id:"dokan-spinner-overlay",style:{display:e?"block":"none"}},(0,r.createElement)("div",{className:"dokan-spinner-wrapper"},(0,r.createElement)("span",{className:"dokan-loading-spinner"}))),i=window.wp.element,s=({value:e="",onClick:t,isDeliveryEnabled:o=!1,isPickupEnabled:n=!1})=>(0,r.createElement)("div",{className:"dokan-store-location-selector"},(0,r.createElement)("div",{className:"selector-wrapper"},o&&(0,r.createElement)("div",{onClick:()=>t("delivery"),"data-selector":"delivery",className:"selector mr-16 "+("delivery"===e?"active-selector":"")},(0,r.createElement)("svg",{height:"18",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},(0,r.createElement)("path",{d:"M386.689 304.403c-35.587 0-64.538 28.951-64.538 64.538s28.951 64.538 64.538 64.538c35.593 0 64.538-28.951 64.538-64.538s-28.951-64.538-64.538-64.538zm0 96.807c-17.796 0-32.269-14.473-32.269-32.269s14.473-32.269 32.269-32.269 32.269 14.473 32.269 32.269c0 17.797-14.473 32.269-32.269 32.269zM166.185 304.403c-35.587 0-64.538 28.951-64.538 64.538s28.951 64.538 64.538 64.538 64.538-28.951 64.538-64.538-28.951-64.538-64.538-64.538zm0 96.807c-17.796 0-32.269-14.473-32.269-32.269s14.473-32.269 32.269-32.269c17.791 0 32.269 14.473 32.269 32.269 0 17.797-14.473 32.269-32.269 32.269zM430.15 119.675a16.143 16.143 0 00-14.419-8.885h-84.975v32.269h75.025l43.934 87.384 28.838-14.5-48.403-96.268z"}),(0,r.createElement)("path",{d:"M216.202 353.345h122.084v32.269H216.202zM117.781 353.345H61.849c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h55.933c8.912 0 16.134-7.223 16.134-16.134 0-8.912-7.223-16.134-16.135-16.134zM508.612 254.709l-31.736-40.874a16.112 16.112 0 00-12.741-6.239H346.891V94.655c0-8.912-7.223-16.134-16.134-16.134H61.849c-8.912 0-16.134 7.223-16.134 16.134s7.223 16.134 16.134 16.134h252.773V223.73c0 8.912 7.223 16.134 16.134 16.134h125.478l23.497 30.268v83.211h-44.639c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h60.773c8.912 0 16.134-7.223 16.135-16.134V264.605c0-3.582-1.194-7.067-3.388-9.896zM116.706 271.597H42.487c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h74.218c8.912 0 16.134-7.223 16.134-16.134.001-8.911-7.222-16.134-16.133-16.134zM153.815 208.134H16.134C7.223 208.134 0 215.357 0 224.269s7.223 16.134 16.134 16.134h137.681c8.912 0 16.134-7.223 16.134-16.134s-7.222-16.135-16.134-16.135z"}),(0,r.createElement)("path",{d:"M180.168 144.672H42.487c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h137.681c8.912 0 16.134-7.223 16.134-16.134.001-8.911-7.222-16.134-16.134-16.134z"})),(0,r.createElement)("span",null,(0,l.__)("Delivery","dokan")),(0,r.createElement)("div",{className:"dokan-delivery-time-tooltip info-icon","data-tip":(0,l.__)("Home delivery at your doorstep","dokan")},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})))),n&&(0,r.createElement)("div",{onClick:()=>t("pickup"),"data-selector":"store-pickup",className:"selector "+("pickup"===e?"active-selector":"pickup")},(0,r.createElement)("svg",{height:"18",viewBox:"0 0 512.456 512.456",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M446.125 305.557l-10.088-195.203h-64.368V35.309H259.952v75.046h-46.57V35.309H101.665v75.046H10.987L0 477.147h512.456v-171.59zm-38.578-165.203l8.539 165.203H309.907l-4.949-165.203h36.711v34.308h30v-34.308zm-65.878-75.045v45.046h-51.717V65.309zm-210.004 0h51.717v45.046h-51.717zM30.912 447.147l9.19-306.793h61.562v34.308h30v-34.308h51.717v34.308h30v-34.308h61.562l9.191 306.793zm283.237 0l-3.343-111.59h59.168v111.59zm168.307 0h-82.481v-111.59h82.481z"}),(0,r.createElement)("path",{d:"M106.68 280.182h101.688v30H106.68z"})),(0,r.createElement)("span",null,(0,l.__)("Pickup","dokan")),(0,r.createElement)("div",{className:"dokan-delivery-time-tooltip info-icon","data-tip":(0,l.__)("Pickup products from your preferred store location","dokan")},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})))))),d=window.wp.apiFetch;var c=o.n(d);const{addQueryArgs:v}=wp.url,{SelectControl:m}=wp.components,_=({vendorId:e,info:t,onChange:o,values:n,setLoading:a})=>{var d,_,p,u,y,h,k,E,f,w,g,b;const x=(0,i.useRef)(null),[S,z]=(0,i.useState)({vendor_id:e,store_name:null!==(d=t?.store_name)&&void 0!==d?d:"",delivery_date:null!==(_=n?.delivery_date)&&void 0!==_?_:"",selected_delivery_type:null!==(p=n?.selected_delivery_type)&&void 0!==p?p:"delivery",delivery_time_slot:null!==(u=n?.delivery_time_slot)&&void 0!==u?u:"",store_pickup_location:null!==(y=n?.store_pickup_location)&&void 0!==y?y:"",timeSlots:null!==(h=n?.timeSlots)&&void 0!==h?h:[],locationSlots:null!==(k=n?.locationSlots)&&void 0!==k?k:[]});(0,i.useEffect)((()=>{(()=>{const e={disable:[],minDate:"today",altInput:!0,altFormat:window.dokan_helper.i18n_date_format.replace("jS","J"),dateFormat:"Y-m-d",locale:dokan_flatpickr_i18n,disableDays:[],onChange:j};let o=[];const r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],l=t.vendor_delivery_options?.delivery_day,n=void 0!==l?Object.entries(l).map((e=>parseInt(e[1])||e[0]===e[1]?e[0]:"")).filter((e=>null!==e?e:"")):[];if(!n.length)return;o=n;const a=[];r.forEach((e=>{o.includes(e)||a.push(r.indexOf(e))})),e.disableDays=[function(e){return a.includes(e.getDay())}],e.disable=[...e.disableDays];const i=t.vendor_vacation_days,s=t.vendor_preorder_blocked_dates;e.disable=[...e.disableDays,...i,...s],delete e.disableDays,window.flatpickr(x.current,e)})()}),[]);const N=e=>{z(e),o(e)},M=e=>(a(!0),c()({path:v("/dokan/v1/delivery-time/time-slot",{vendorId:e.vendor_id,date:e.delivery_date})}).then((t=>{if("object"==typeof t){const r={...e};return r.delivery_time_slot="",r.timeSlots=Object.keys(t),z(r),o(r),r}throw new Error("Invalid response format")})).finally((()=>{a(!1)}))),O=e=>(a(!0),c()({path:v("/dokan/v1/delivery-time/location-slot",{vendorId:e.vendor_id})}).then((t=>{if("object"==typeof t){const r={...e};return r.locationSlots=Object.values(t),z(r),o(r),r}throw new Error("Invalid response format")})).finally((()=>(a(!1),!0))));function j(e,t,o){const r={...S,delivery_date:t};O(r).then((e=>{M(e)}))}const D=e=>e?{name:e.split("(")[0],address:e.match(/\((.*?)\)/)[1]}:{name:"",address:""};return(0,r.createElement)("div",{className:"delivery-group"},(0,r.createElement)("div",{className:"title"},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",height:"22",viewBox:"0 0 24 24",stroke:"#333333"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})),(0,r.createElement)("span",null,null!==(E=t?.store_name)&&void 0!==E?E:"")),(0,r.createElement)("div",{className:"vendor-info"},(0,r.createElement)("span",null,null!==(f=t?.vendor_delivery_options?.delivery_box_info_message)&&void 0!==f?f:"")),(0,r.createElement)(s,{value:S?.selected_delivery_type,onClick:e=>{const t={...S,selected_delivery_type:e};O(t).then((e=>{N(e)}))},isDeliveryEnabled:t?.is_delivery_time_active,isPickupEnabled:t?.is_store_location_active}),(0,r.createElement)("input",{defaultValue:S?.delivery_date||"",readOnly:!0,ref:x,className:"delivery-time-date-picker flatpickr-input",type:"text",placeholder:null!==(w=t?.vendor_delivery_options?.delivery_date_label)&&void 0!==w?w:(0,l.__)("Delivery Date","dokan")}),Number(S.timeSlots.length)>0&&(0,r.createElement)(m,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>N({...S,delivery_time_slot:e}),className:"delivery-time-vendor-select",value:null!==(g=S.delivery_time_slot)&&void 0!==g?g:"",options:(()=>{const e=S.timeSlots.map((e=>({label:e,value:e})));return e.push({label:(0,l.__)("Select time slot","dokan"),value:""}),e})()}),S.locationSlots.length>0&&"pickup"===S.selected_delivery_type&&(0,r.createElement)("div",{className:"store-pickup-select-options"},(0,r.createElement)(m,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>N({...S,store_pickup_location:e}),className:"delivery-time-vendor-select",value:null!==(b=S.store_pickup_location)&&void 0!==b?b:"",options:(()=>{const e=S.locationSlots.map((e=>({label:D(e).name,value:e})));return e.push({label:(0,l.__)("Select store location","dokan"),value:""}),e})()}),S.store_pickup_location&&(0,r.createElement)("div",{className:"store-address vendor-info"},(0,r.createElement)("span",{id:"delivery-store-location-address-3"},D(S.store_pickup_location).address))),(0,r.createElement)("hr",null))},p=({message:e=""})=>(0,r.createElement)("div",{className:"dokan-delivery-time-error"},(0,r.createElement)("div",{className:"dokan-delivery-time-error-message"},(0,r.createElement)(i.RawHTML,null,e))),u=window.wc.wcSettings.getSetting("dokan_delivery_time_data"),y=e=>{var t;const[o,s]=(0,i.useState)(!1),[d,c]=(0,i.useState)({}),v=null!==(t=u?.dateTime)&&void 0!==t?t:"",m=u?.vendorInfo,y={delivery_date:"",delivery_time_slot:"",locationSlots:[],selected_delivery_type:"pickup",store_name:"",store_pickup_location:"",timeSlots:[],vendor_id:"0"},h=e=>{let t="";return Object.values(e).forEach((e=>{(t||e.vendor_id)&&(t||e.store_name)?t||e.selected_delivery_type?t||e.delivery_date?t||e.delivery_time_slot?t||"pickup"!==e.selected_delivery_type||e.store_pickup_location||(t=(0,l.sprintf)((0,l.__)("Please make sure you have selected the store pickup location for %s.","dokan"),e.store_name)):t=(0,l.sprintf)((0,l.__)("Please make sure you have selected the delivery time slot for %s.","dokan"),e.store_name):t=(0,l.sprintf)((0,l.__)("Please make sure you have selected the Delivery date for %s.","dokan"),e.store_name):t=(0,l.__)("Select a delivery type.","dokan"):t=(0,l.__)("Vendor not found.","dokan")})),t};(0,i.useEffect)((()=>{const t={};Object.keys(m).forEach((e=>{let o="";m[e].is_store_location_active&&(o="pickup"),m[e].is_delivery_time_active&&(o="delivery"),t[e]={...y,selected_delivery_type:o,store_name:m[e].store_name,vendor_id:e}})),c(t),Object.values(d).length||e.onChange({data:t,error:(0,l.__)("Please select your delivery time.","dokan")})}),[]);const k=()=>{if(void 0!==u?.vendorInfo&&"object"==typeof u?.vendorInfo)return(0,r.createElement)("div",{className:"delivery-time-body"},(0,r.createElement)(a,{isLoading:o}),Object.keys(m).map((t=>{return(0,r.createElement)(_,{key:t,vendorId:t,info:m[t],onChange:o=>((t,o)=>{const r={...d,[t]:o};c(r),e.onChange({data:r,error:h(r)})})(t,o),values:(o=t,d[o]),setLoading:s});var o})))};return(0,r.createElement)((()=>u?.delivery_time_enabled?(0,r.createElement)("div",{id:"dokan-delivery-time-box"},e.error&&(0,r.createElement)(p,{message:e.error}),(0,r.createElement)(n,{time:v}),(0,r.createElement)(k,null)):(0,r.createElement)(r.Fragment,null)),null)},h=window.wc.blocksCheckout,k=window.wp.plugins,E=JSON.parse('{"name":"dokan/delivery-time","version":"1.0.0","title":"Dokan delivery time","description":"Dokan delivery time checkout block","category":"woocommerce","supports":{"align":false,"html":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-totals-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}}},"textdomain":"dokan","$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2}'),f=window.wc.wcSettings.getSetting("dokan_delivery_time_data");(0,k.registerPlugin)("dokan-delivery-time",{render:()=>"",scope:"woocommerce-checkout"}),(0,h.registerCheckoutBlock)({metadata:E,component:e=>{var t;const{checkoutExtensionData:o,extensions:l}=e,{setExtensionData:n}=o,{setValidationErrors:a,hasValidationErrors:s,getValidationError:d,clearValidationError:c,hideValidationError:v}=e.validation,m="dokan-delivery-time",[_,p]=(0,i.useState)(""),u=null!==(t=f?.vendorInfo)&&void 0!==t?t:{};return f?.delivery_time_enabled&&Object.keys(u).length?(0,r.createElement)(h.ExperimentalOrderMeta,null,(0,r.createElement)(y,{extentionProps:e,onChange:e=>{var t;const o=null!==(t=e?.data)&&void 0!==t?t:{};p(e.error&&f?.is_time_selection_required?e.error:""),e.error&&f?.is_time_selection_required?a({[m]:{message:e.error,hidden:!1}}):c(m),(e=>{const t=Object.values(e).map((e=>{var t,o,r,l,n;return{vendor_id:null!==(t=e?.vendor_id)&&void 0!==t?t:"",store_name:null!==(o=e?.store_name)&&void 0!==o?o:"",delivery_date:null!==(r=e?.delivery_date)&&void 0!==r?r:"",selected_delivery_type:e?.selected_delivery_type&&"pickup"===e?.selected_delivery_type?"store-pickup":e?.selected_delivery_type&&"delivery"===e?.selected_delivery_type?"delivery":"",delivery_time_slot:null!==(l=e?.delivery_time_slot)&&void 0!==l?l:"",store_pickup_location:null!==(n=e?.store_pickup_location)&&void 0!==n?n:""}}));n("dokan_delivery_time","vendor_delivery_time",t)})(o)},error:_})):(0,r.createElement)(r.Fragment,null)}})}},o={};function r(e){var l=o[e];if(void 0!==l)return l.exports;var n=o[e]={exports:{}};return t[e](n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,o,l,n)=>{if(!o){var a=1/0;for(c=0;c<e.length;c++){for(var[o,l,n]=e[c],i=!0,s=0;s<o.length;s++)(!1&n||a>=n)&&Object.keys(r.O).every((e=>r.O[e](o[s])))?o.splice(s--,1):(i=!1,n<a&&(a=n));if(i){e.splice(c--,1);var d=l();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,l,n]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={2894:0,8322:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var l,n,[a,i,s]=o,d=0;if(a.some((t=>0!==e[t]))){for(l in i)r.o(i,l)&&(r.m[l]=i[l]);if(s)var c=s(r)}for(t&&t(o);d<a.length;d++)n=a[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},o=globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var l=r.O(void 0,[8322],(()=>r(64)));l=r.O(l)})();