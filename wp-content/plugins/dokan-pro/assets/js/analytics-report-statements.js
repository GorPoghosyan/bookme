"use strict";(globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[]).push([[8815],{3734:(e,a,t)=>{t.r(a),t.d(a,{default:()=>w});var r=t(1609),n=t(3832),d=t(7723),l=t(6427),s=t(6087),o=t(3973),c=t(1641),m=t(1455),i=t.n(m);const g=()=>(0,r.createElement)("div",{className:"w-full space-y-6 animate-pulse pr-4 pb-4"},(0,r.createElement)("div",{className:"flex justify-between items-center"},(0,r.createElement)("div",{className:"flex gap-4"},(0,r.createElement)("div",{className:"h-10 w-40 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-10 w-40 bg-gray-200 rounded"})),(0,r.createElement)("div",{className:"h-10 w-32 bg-gray-200 rounded"})),(0,r.createElement)("div",{className:"grid grid-cols-3 gap-4"},(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border space-y-2"},(0,r.createElement)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-32 bg-gray-200 rounded"})),(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border space-y-2"},(0,r.createElement)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-32 bg-gray-200 rounded"})),(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border space-y-2"},(0,r.createElement)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-32 bg-gray-200 rounded"})))),u=()=>(0,r.createElement)("div",{className:"w-full space-y-6 animate-pulse pr-4 pb-4"},(0,r.createElement)("div",{className:"border border-gray-200 rounded-lg overflow-hidden"},(0,r.createElement)("div",{className:"grid grid-cols-7 gap-4 p-4 bg-gray-50"},(0,r.createElement)("div",{className:"h-4 w-28 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-28 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-16 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-20 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," ",(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," "),[1,2,3,4,5,6,7,8].map((e=>(0,r.createElement)("div",{key:e,className:"grid grid-cols-7 gap-4 p-4 border-t border-gray-200"},(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-12 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-16 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-20 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-20 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-4 w-20 bg-gray-200 rounded"}))))),(0,r.createElement)("div",{className:"flex justify-between items-center p-4"},(0,r.createElement)("div",{className:"flex gap-2"},(0,r.createElement)("div",{className:"h-8 w-24 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-24 bg-gray-200 rounded"})),(0,r.createElement)("div",{className:"flex gap-2"},(0,r.createElement)("div",{className:"h-8 w-8 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-8 bg-gray-200 rounded"}),(0,r.createElement)("div",{className:"h-8 w-8 bg-gray-200 rounded"}))));var b=t(4408),p=t(7832),_=t(8486),h=t(8846),y=t(2619);const E=e=>{var a;const t=(0,s.useRef)(null);(0,_.Wr)(t,(()=>e.setShow(!e.show)));const n=(0,y.applyFilters)("dokan_analytics_report_statement_date_range_picker_props",{...e});return(0,r.createElement)(b.AM,{className:"relative"},(0,r.createElement)(b.ut,{onClick:()=>n.setShow(!n.show),className:"shadow-none w-full focus:outline-none p-0"},null!==(a=e.children)&&void 0!==a?a:""),(0,r.createElement)(p.e,{show:n.show,enter:"transition duration-200 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-150 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0"},(0,r.createElement)(b.QT,{anchor:"bottom",className:"absolute flex rounded shadow-xl border"},(0,r.createElement)("div",{className:"w-auto flex-auto overflow-hidden bg-white z-40",ref:t},(0,r.createElement)(h.DateRange,{...n})))))};var v=t(8443);const w=()=>{const e=(0,c.dj)(),[a,t]=(0,s.useState)(!0),[m,b]=(0,s.useState)(!0),[p,_]=(0,s.useState)([{end_date:"",start_date:"",formatted_entries:[],summary:{total_debit:0,total_credit:0,balance:0}}]),[h,y]=(0,s.useState)([]),[w,f]=(0,s.useState)({start_date:p.start_date,end_date:p.end_date}),[N,k]=(0,s.useState)({page:1,perPage:10,type:"table",titleField:"balance_date",fields:["trn_date","trn_id","trn_type","debit","credit","balance"]}),[S,x]=(0,s.useState)({total_debit:0,total_credit:0,balance:0}),[T,D]=(0,s.useState)(p.start_date),[I,C]=(0,s.useState)(""),[F,M]=(0,s.useState)(p.end_date),[P,j]=(0,s.useState)(""),[B,H]=(0,s.useState)("startDate"),[O,R]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(async a=>{b(!0);try{const e=await i()({path:(0,n.addQueryArgs)("/dokan/v1/vendor/reports/statement/summary",a),method:"GET"});x(e)}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to fetch summary data","dokan")}),p.summary&&x(p.summary)}finally{b(!1)}})({end_date:w.end_date,start_date:w.start_date})}),[w]),(0,s.useEffect)((()=>{(async a=>{t(!0);try{const e=await i()({path:(0,n.addQueryArgs)("/dokan/v1/vendor/reports/statement",a),method:"GET"});_(e)}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to fetch statement data","dokan")})}finally{t(!1)}})({per_page:-1,page:N.page,end_date:w.end_date,start_date:w.start_date})}),[w]);const Y=[{id:"balance_date",label:(0,d.__)("Balance Date","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):(0,v.dateI18n)((0,v.getSettings)().formats.date,e.balance_date),enableSorting:!1},{id:"trn_date",label:(0,d.__)("Transaction Date","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_date?(0,v.dateI18n)((0,v.getSettings)().formats.date,e.trn_date):(0,d.__)("--","dokan"),enableSorting:!1},{id:"trn_id",label:(0,d.__)("ID","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_id?(0,r.createElement)("a",{href:e.url,className:"statement-order-id"},(0,d.sprintf)((0,d.__)("#%s","dokan"),e.trn_id)):(0,d.__)("--","dokan"),enableSorting:!1},{id:"trn_type",label:(0,d.__)("Type","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_title,enableSorting:!1},{id:"debit",label:(0,d.__)("Debit","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):"opening_balance"!==e?.trn_type?(0,r.createElement)(o.PriceHtml,{price:e?.debit}):(0,d.__)("--","dokan"),enableSorting:!1},{id:"credit",label:(0,d.__)("Credit","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):"opening_balance"!==e?.trn_type?(0,r.createElement)(o.PriceHtml,{price:e?.credit}):(0,d.__)("--","dokan"),enableSorting:!1},{id:"balance",label:(0,d.__)("Balance","dokan"),render:({item:e})=>a?(0,r.createElement)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):(0,r.createElement)(o.PriceHtml,{price:e?.balance}),enableSorting:!1}],[L,U]=(0,s.useState)(!1),{data:A,paginationInfo:G}=(0,s.useMemo)((()=>(0,o.filterSortAndPaginate)(p,N,Y)),[N]);return(0,r.createElement)(s.Suspense,{fallback:(0,r.createElement)(l.Spinner,null)},(0,r.createElement)(l.Fill,{name:"woocommerce_header_item"},(0,r.createElement)("h3",{className:"dokan-analytics-vendor-earning-section dokan-layout"},(0,r.createElement)(o.DokanButton,{variant:"primary",onClick:async()=>{R(!0);const a=(0,v.dateI18n)("Y-m-d",w.start_date||vendorSharedSettings?.firstDayOfTheMonth),t=(0,v.dateI18n)("Y-m-d",w.end_date||vendorSharedSettings?.endDayOfTheMonth);try{const r=await i()({path:`/dokan/v1/vendor/reports/statement/export?start_date=${a}&end_date=${t}`,method:"GET"}),n=new Blob([r.content],{type:"text/csv"}),l=window.URL.createObjectURL(n),s=document.createElement("a");s.href=l,s.download=`${r.file_name}.csv`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(l),document.body.removeChild(s),e({type:"success",title:(0,d.__)("Statement exported successfully","dokan")})}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to export statement","dokan")})}finally{R(!1)}},disabled:m||O},(0,d.__)("Export Statement","dokan")))),(0,r.createElement)("div",{className:"dokan-report-statement-wrapper pr-4 pb-4"},(0,r.createElement)("span",{className:"woocommerce-filters-label"},(0,d.__)("Statement range:","dokan")),m?(0,r.createElement)(g,null):(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,r.createElement)("div",{className:"flex gap-4"},(0,r.createElement)(E,{show:L,after:T,setShow:U,afterText:I,before:F,beforeText:P,onUpdate:e=>{e.after&&D(e.after),e.afterText&&C(e.afterText),e.before&&(M(e.before),f({start_date:e.after,end_date:e.before})),e.beforeText&&j(e.beforeText),e.focusedInput&&(H(e.focusedInput),"endDate"!==e.focusedInput&&U(!1),"endDate"===e.focusedInput&&T&&(M(""),j(""),U(!0)))},shortDateFormat:"MM/DD/YYYY",focusedInput:B,isInvalidDate:e=>moment().isBefore(moment(e),"date")},(0,r.createElement)("div",{className:"dokan-layout w-96"},(0,r.createElement)("span",{className:"components-button woocommerce-dropdown-button is-multi-line p-2.5 h-full justify-start"},(0,r.createElement)("span",{className:"woocommerce-dropdown-button__label font-semibold"},(0,d.sprintf)((0,d.__)("%s - %s","dokan"),(0,v.dateI18n)((0,v.getSettings)().formats.date,w.start_date||p.start_date||vendorSharedSettings?.firstDayOfTheMonth),(0,v.dateI18n)((0,v.getSettings)().formats.date,w.end_date||p.end_date||vendorSharedSettings?.lastDayOfTheMonth)))))))),(0,r.createElement)("div",{className:"mb-6 grid grid-cols-3 gap-4"},(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200"},(0,r.createElement)("h3",{className:"text-lg font-bold mb-2"},(0,d.__)("Total Debit","dokan")),m?(0,r.createElement)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,r.createElement)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0"},(0,r.createElement)(o.PriceHtml,{price:S?.total_debit}))),(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200"},(0,r.createElement)("h3",{className:"text-lg font-bold mb-2"},(0,d.__)("Total Credit","dokan")),m?(0,r.createElement)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,r.createElement)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0"},(0,r.createElement)(o.PriceHtml,{price:S?.total_credit}))),(0,r.createElement)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200"},(0,r.createElement)("h3",{className:"text-lg font-bold mb-2"},(0,d.__)("Balance","dokan")),m?(0,r.createElement)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,r.createElement)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0"},(0,r.createElement)(o.PriceHtml,{price:S?.balance}))))),m||a?(0,r.createElement)(u,null):(0,r.createElement)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg"},(0,r.createElement)(o.DataViews,{view:N,fields:Y,data:A,selection:h,onChangeView:k,onChangeSelection:y,getItemId:e=>e.trn_id||e.balance_date,namespace:"report-statement",defaultLayouts:{density:"comfortable"},paginationInfo:G}))))}}}]);